# 已知问题

## `tarsio.Struct` 动态子类的内存增长问题

**问题**: 动态创建 `tarsio.Struct` 子类并实例化后，子类类型对象可能长期存活，导致内存持续增长。

**复现条件**:

* 仅动态创建子类（不实例化）时，通常可被回收。
* 动态创建可实例化子类并进行实例化后，更容易出现类型对象不回收。

**影响**: 如果业务在无界循环中持续创建并实例化新的 `Struct` 子类（例如按请求动态生成 schema），进程内存会持续上升。

**根因说明**: 目前更可能是 PyO3 与 CPython 在类型生命周期上的交互问题。`tp_subclasses` 强引用并非已确认结论，根因仍待上游进一步确认。

**临时规避方案**:

* 避免无界动态建类，优先对 `Struct` 类进行缓存与复用。
* 若必须动态生成，建议在独立 worker 进程中执行并定期重启回收内存。
